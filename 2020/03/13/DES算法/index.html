<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Lato:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"ran-barry.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:"disqus",storage:!0,lazyload:!1,nav:{disqus:{text:"Disqus 评论",order:-1},livere:{text:"LiveRe 评论",order:-2}}},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:-1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="本文为DES算法的原理详解"><meta property="og:type" content="article"><meta property="og:title" content="DES算法"><meta property="og:url" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/index.html"><meta property="og:site_name" content="Hello"><meta property="og:description" content="本文为DES算法的原理详解"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/01.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/02.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/03.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/04.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/05.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/06.png"><meta property="og:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/07.png"><meta property="article:published_time" content="2020-03-13T13:37:58.000Z"><meta property="article:modified_time" content="2020-03-13T13:37:58.000Z"><meta property="article:author" content="Ran-Barry"><meta property="article:tag" content="算法"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/01.png"><link rel="canonical" href="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>DES算法 | Hello</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Hello</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">记录学习等</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><a href="https://github.com/Ran-Barry" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="Ran-Barry"><meta itemprop="description" content=""></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hello"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">DES算法</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-03-13 21:37:58" itemprop="dateCreated datePublished" datetime="2020-03-13T21:37:58+08:00">2020-03-13</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>11k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>10 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="本文为DES算法的原理详解"><a href="#本文为DES算法的原理详解" class="headerlink" title="本文为DES算法的原理详解"></a>本文为DES算法的原理详解</h2><span id="more"></span><h2 id="DES算法详解"><a href="#DES算法详解" class="headerlink" title="DES算法详解"></a>DES算法详解</h2><h3 id="算法简介"><a href="#算法简介" class="headerlink" title="算法简介"></a>算法简介</h3><p>DES是一个分组加密算法，典型的DES以64位为分组数据加密，加密和解密用的是同一算法。<br>它的密钥长度是56比特。尽管从规格上来说，DES的密钥长度是64比特，但由于每个7比特会设置一个用于错误检验的比特，因此实质上其密钥长度是56比特。<br>加密算法流程：<br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/01.png" alt="9090bbfe6a422c74e42749050102f862.png"></p><h3 id="明文初始置换（IP初始置换）"><a href="#明文初始置换（IP初始置换）" class="headerlink" title="明文初始置换（IP初始置换）"></a>明文初始置换（IP初始置换）</h3><p>IP置换目的是将输入的64位明文数据块按位重新组合，并把输出分为L0，R0两部分，每部分各长32位。<br><strong>注意：这里的数字表示的是原数据的位置，不是数据</strong></p><p>置换规则如下表：</p><blockquote><p>58,50,42,34,26,18,10,2,<br>60,52,44,36,28,20,12,4,<br>62,54,46,38,30,22,14,6,<br>64,56,48,40,32,24,16,8,<br>57,49,41,33,25,17, 9,1,<br>59,51,43,35,27,19,11,3,<br>61,53,45,37,29,21,13,5,<br>63,55,47,39,31,23,15,7,</p></blockquote><p>即将第58位明文换到第一个位置，第50位明文换到第2位。以此类推。<br>L0:</p><blockquote><p>58,50,42,34,26,18,10,2,<br>60,52,44,36,28,20,12,4,<br>62,54,46,38,30,22,14,6,<br>64,56,48,40,32,24,16,8,</p></blockquote><p>R0:</p><blockquote><p>57,49,41,33,25,17, 9,1,<br>59,51,43,35,27,19,11,3,<br>61,53,45,37,29,21,13,5,<br>63,55,47,39,31,23,15,7,</p></blockquote><p>然后分为左右两部分</p><h3 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h3><h4 id="密钥初始置换（密钥由64位转为56位）"><a href="#密钥初始置换（密钥由64位转为56位）" class="headerlink" title="密钥初始置换（密钥由64位转为56位）"></a>密钥初始置换（密钥由64位转为56位）</h4><p><strong>操作对象是64位秘钥</strong></p><p>不考虑每个字节的第8位，DES的密钥由64位减至56位，每个字节的第8位作为奇偶校验位。产生的56位密钥由下表生成（注意表中没有8，16，24，32，40，48，56和64这8位）：<br><strong>注意：这里的数字表示的是原数据的位置，不是数据</strong><br>C0:</p><blockquote><p>57,49,41,33,25,17,9<br>1,58,50,42,34,26,18<br>10,2,59,51,43,35,27<br>19,11,3,60,52,44,36</p></blockquote><p>D0:</p><blockquote><p>63,55,47,39,31,23,15<br>7,62,54,46,38,30,22<br>14,6,61,53,45,37,29<br>21,13,5,28,20,12,4</p></blockquote><h4 id="生成16个48位的子密钥"><a href="#生成16个48位的子密钥" class="headerlink" title="生成16个48位的子密钥"></a>生成16个48位的子密钥</h4><p>在DES的每一轮中，从56位密钥产生出不同的48子密钥，确定这些子密钥的方式如下：<br>1）将56位密钥分成两部分，每部分28位。<br>2）根据轮数，这两部分分别循环左移1位或2位。每轮移动的位数如下表：<br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/02.png" alt="15b5906b4985620fae91c07441373fd3.png"></p><h5 id="第一轮循环左移1位"><a href="#第一轮循环左移1位" class="headerlink" title="第一轮循环左移1位"></a>第一轮循环左移1位</h5><p>C1:</p><blockquote><p>49,41,33,25,17,9,1<br>58,50,42,34,26,18,10<br>2,59,51,43,35,27,19<br>11,3,60,52,44,36,57</p></blockquote><p>D1:</p><blockquote><p>55,47,39,31,23,15,7,<br>62,54,46,38,30,22,14,<br>6,61,53,45,37,29,21,<br>13,5,28,20,12,4,63</p></blockquote><p>C1和D1合并之后，再经过置换表2生成48位的子密钥k1。<strong>56位转48位</strong><br><strong>置换表2</strong></p><blockquote><p>14,17,11,24,1,5<br>3,28,15,6,21,10<br>23,19,12,4,26,8<br>16,7,27,20,13,2<br>41,52,31,37,47,55<br>30,40,51,45,33,48<br>44.,49,39,56,34,53<br>46,42,50,36,29,32</p></blockquote><p>C1和D1再次经过循环左移变换，生成C2和D2，C2和D2合并，通过置换表2生成子秘钥K2。<br>以此类推，得到子秘钥K1~K16。需要注意其中循环左移的位数。</p><h3 id="16轮迭代（F函数）"><a href="#16轮迭代（F函数）" class="headerlink" title="16轮迭代（F函数）"></a>16轮迭代（F函数）</h3><h4 id="明文扩展置换（E盒扩展32位转48位）"><a href="#明文扩展置换（E盒扩展32位转48位）" class="headerlink" title="明文扩展置换（E盒扩展32位转48位）"></a>明文扩展置换（E盒扩展32位转48位）</h4><p>输入初始置换后明文右侧32位，最后变为48位。<br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/03.png" alt="ca8801b6152ca8f712914df35f077989.png"><br>扩展规则如下：<br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/04.png" alt="39726d21a7ff43ec18c06d4d8f3c2bd7.png"></p><blockquote><p>32,1,2,3,4,5,<br>4,5,6,7,8,9,<br>8,9,10,11,12,13,<br>12,13,14,15,16,17,<br>16,17,18,19,20,21,<br>20,21,22,23,24,25,<br>24,25,26,27,28,29,<br>28,29,30,31,32,1</p></blockquote><h4 id="S盒替代"><a href="#S盒替代" class="headerlink" title="S盒替代"></a>S盒替代</h4><p>压缩后的密钥与扩展分组异或以后得到48位的数据，将这个数据送入S盒，进行替代运算。替代由8个不同的S盒完成，每个S盒有6位输入4位输出。48位输入分为8个6位的分组，一个分组对应一个S盒，对应的S盒对各组进行代替操作。<br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/05.png" alt="130b775c24f796bf9a930d813808389b.png"><br><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/06.png" alt="734d32e5dad6ee761f501b0703cc5e6d.png"></p><p>一个S盒就是一个4行16列的表，盒中的每一项都是一个4位的数。S盒的6个输入确定了其对应的输出在哪一行哪一列，输入的<strong>高低两位做为行数H</strong>，<strong>中间四位做为列数L</strong>，在S-BOX中查找第H行L列对应的数据(&lt;32)。</p><h5 id="8个S盒"><a href="#8个S盒" class="headerlink" title="8个S盒"></a>8个S盒</h5><p><strong>S盒1：</strong></p><blockquote><p>14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7,<br>0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8,<br>4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0,<br>15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13,</p></blockquote><p><strong>S盒2：</strong></p><blockquote><p>15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10,<br>3,13,4,7,15,2,8,14,12,0,1,10,6,9,11,5,<br>0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15,<br>13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9,</p></blockquote><p><strong>S盒3：</strong></p><blockquote><p>10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8,<br>13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1,<br>13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7,<br>1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12,</p></blockquote><p><strong>S盒4：</strong></p><blockquote><p>7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15,<br>13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9,<br>10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4,<br>3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14,</p></blockquote><p><strong>S盒5：</strong></p><blockquote><p>2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9,<br>14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6,<br>4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14,<br>11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3,</p></blockquote><p><strong>S盒6：</strong></p><blockquote><p>12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11,<br>10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8,<br>9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6,<br>4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13,</p></blockquote><p><strong>S盒7：</strong></p><blockquote><p>4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1,<br>13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6,<br>1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2,<br>6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12,</p></blockquote><p><strong>S盒8：</strong></p><blockquote><p>13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7,<br>1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2,<br>7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8,<br>2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11,</p></blockquote><p><img src="/2020/03/13/DES%E7%AE%97%E6%B3%95/07.png" alt="5c79891ddb9cda188777b0475500e3ab.png"></p><p>例如，假设S盒8的输入为110011，第1位和第6位组合为11，对应于S盒8的第3行；第2位到第5位为1001，对应于S盒8的第9列。S盒8的第3行第9列的数字为12，因此用1100来代替110011。注意，S盒的行列计数都是从0开始。</p><p>代替过程产生8个4位的分组，组合在一起形成32位数据。</p><p>S盒代替是DES算法的关键步骤，所有的其他的运算都是线性的，易于分析，而S盒是非线性的，相比于其他步骤，提供了更好安全性。</p><h4 id="P盒置换"><a href="#P盒置换" class="headerlink" title="P盒置换"></a>P盒置换</h4><p>S盒代替运算的32位输出按照P盒进行置换。该置换把输入的每位映射到输出位，任何一位不能被映射两次，也不能被略去，映射规则如下表：</p><blockquote><p>16,7,20,21,29,12,28,17,1,15,23,26,5,18,31,10,<br>2,8,24,14,32,27,3,9,19,13,30,6,22,11,4,25,</p></blockquote><p>表中的数字代表原数据中此位置的数据在新数据中的位置，即原数据块的第16位放到新数据的第1位，第7位放到第2位，……依此类推，第25位放到第32位。</p><p>最后，P盒置换的结果与最初的64位分组左半部分L0异或，然后左、右半部分交换，接着开始另一轮</p><h3 id="末置换"><a href="#末置换" class="headerlink" title="末置换"></a>末置换</h3><p>末置换是初始置换的逆过程，DES最后一轮后，左、右两半部分并未进行交换，而是两部分合并形成一个分组做为末置换的输入。末置换规则如下：</p><blockquote><p>40,8,48,16,56,24,64,32,39,7,47,15,55,23,63,31,<br>38,6,46,14,54,22,62,30,37,5,45,13,53,21,61,29,<br>36,4,44,12,52,20,60,28,35,3,43,11,51,19,59,27,<br>34,2,42,10,50,18,58,26,33,1,41,9,49,17,57,25,</p></blockquote><h3 id="DES的解密"><a href="#DES的解密" class="headerlink" title="DES的解密"></a>DES的解密</h3><p>加密和解密可以使用相同的算法。加密和解密唯一不同的是秘钥的次序是相反的。就是说如果每一轮的加密秘钥分别是K1、K2、K3…K16，那么解密秘钥就是K16、K15、K14…K1。</p><h2 id="代码实现（python）"><a href="#代码实现（python）" class="headerlink" title="代码实现（python）"></a>代码实现（python）</h2><h3 id="密钥生成部分"><a href="#密钥生成部分" class="headerlink" title="密钥生成部分"></a>密钥生成部分</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">MaxTime = <span class="number">16</span></span><br><span class="line"><span class="comment"># 密钥初始置换 64位密钥转换为56位</span></span><br><span class="line">key_table1 = [<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,</span><br><span class="line">              <span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,</span><br><span class="line">              <span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,</span><br><span class="line">              <span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,</span><br><span class="line">              <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,</span><br><span class="line">              <span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,</span><br><span class="line">              <span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,</span><br><span class="line">              <span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>]</span><br><span class="line"><span class="comment"># 密钥置换表2 56位转48位</span></span><br><span class="line">key_table2 = [<span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,</span><br><span class="line">              <span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,</span><br><span class="line">              <span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,</span><br><span class="line">              <span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,</span><br><span class="line">              <span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,</span><br><span class="line">              <span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,</span><br><span class="line">              <span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,</span><br><span class="line">              <span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ListMove</span>(<span class="params">l,step</span>):</span> <span class="comment">#将列表中的元素循环左移</span></span><br><span class="line">    <span class="keyword">return</span> l[step:] + l[:step]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SubKey</span>(<span class="params">key</span>):</span> <span class="comment">#生成子密钥</span></span><br><span class="line">    keyresult = []</span><br><span class="line">    key0 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_table1)):  <span class="comment">#密钥初始置换 64位转56位</span></span><br><span class="line">        key0[i] = key[key_table1[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 生成16个密钥</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MaxTime):</span><br><span class="line">        key1 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">        <span class="comment"># 每次位移次数</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span> <span class="keyword">or</span> i == <span class="number">8</span> <span class="keyword">or</span> i == <span class="number">15</span>:</span><br><span class="line">            step = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            step = <span class="number">2</span></span><br><span class="line">        <span class="comment"># 分成左右两部分</span></span><br><span class="line">        temp1 = key0[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">        temp2 = key0[<span class="number">28</span>:<span class="number">56</span>]</span><br><span class="line">        <span class="comment"># 循环左移</span></span><br><span class="line">        temp1 = ListMove(temp1,step)</span><br><span class="line">        temp2 = ListMove(temp2,step)</span><br><span class="line">        <span class="comment"># 左右连接</span></span><br><span class="line">        key0 = temp1 + temp2</span><br><span class="line">        <span class="comment"># 置换 56位转48位</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_table2)):</span><br><span class="line">            key1[i] = key0[key_table2[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 生成密钥</span></span><br><span class="line">        keyresult.append(key1)</span><br><span class="line">    <span class="comment"># 返回每次的密钥</span></span><br><span class="line">    <span class="keyword">return</span> keyresult</span><br></pre></td></tr></table></figure><h3 id="F函数"><a href="#F函数" class="headerlink" title="F函数"></a>F函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">MaxTime = <span class="number">16</span></span><br><span class="line"><span class="comment"># 初始IP置换表</span></span><br><span class="line">IP_table = [<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line">            <span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line">            <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,</span><br><span class="line">            <span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,</span><br><span class="line">            <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>, <span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line">            <span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line">            <span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,</span><br><span class="line">            <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line"><span class="comment"># 逆IP置换表</span></span><br><span class="line">Inv_IP_table = [<span class="number">40</span>,  <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">                <span class="number">39</span>,  <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">                <span class="number">38</span>,  <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">                <span class="number">37</span>,  <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">                <span class="number">36</span>,  <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">                <span class="number">35</span>,  <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">                <span class="number">34</span>,  <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">                <span class="number">33</span>,  <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>]</span><br><span class="line"><span class="comment"># E盒表</span></span><br><span class="line">extend_table = [<span class="number">32</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,</span><br><span class="line">                <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>,</span><br><span class="line">                <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">                <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">                <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">                <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">                <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">                <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>,  <span class="number">1</span>]</span><br><span class="line"><span class="comment"># S1盒</span></span><br><span class="line">S1 = [<span class="number">14</span>,  <span class="number">4</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>,  <span class="number">8</span>,  <span class="number">3</span>, <span class="number">10</span>,  <span class="number">6</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">9</span>,  <span class="number">0</span>,  <span class="number">7</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">15</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">14</span>,  <span class="number">2</span>, <span class="number">13</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">3</span>,  <span class="number">8</span>,</span><br><span class="line">      <span class="number">4</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">8</span>, <span class="number">13</span>,  <span class="number">6</span>,  <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">3</span>, <span class="number">10</span>,  <span class="number">5</span>,  <span class="number">0</span>,</span><br><span class="line">      <span class="number">15</span>, <span class="number">12</span>,  <span class="number">8</span>,  <span class="number">2</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">1</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">13</span>]</span><br><span class="line"><span class="comment"># S2盒</span></span><br><span class="line">S2 = [<span class="number">15</span>,  <span class="number">1</span>,  <span class="number">8</span>, <span class="number">14</span>,  <span class="number">6</span>, <span class="number">11</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">13</span>,  <span class="number">4</span>,  <span class="number">7</span>, <span class="number">15</span>,  <span class="number">2</span>,  <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">9</span>, <span class="number">11</span>,  <span class="number">5</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">14</span>,  <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>,  <span class="number">4</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">3</span>,  <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>,  <span class="number">8</span>, <span class="number">10</span>,  <span class="number">1</span>,  <span class="number">3</span>, <span class="number">15</span>,  <span class="number">4</span>,  <span class="number">2</span>, <span class="number">11</span>,  <span class="number">6</span>,  <span class="number">7</span>, <span class="number">12</span>,  <span class="number">0</span>,  <span class="number">5</span>, <span class="number">14</span>,  <span class="number">9</span>]</span><br><span class="line"><span class="comment"># S3盒</span></span><br><span class="line">S3 = [<span class="number">10</span>,  <span class="number">0</span>,  <span class="number">9</span>, <span class="number">14</span>,  <span class="number">6</span>,  <span class="number">3</span>, <span class="number">15</span>,  <span class="number">5</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">7</span>, <span class="number">11</span>,  <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">8</span>,</span><br><span class="line">      <span class="number">13</span>,  <span class="number">7</span>,  <span class="number">0</span>,  <span class="number">9</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">6</span>, <span class="number">10</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>,  <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>,  <span class="number">6</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">8</span>, <span class="number">15</span>,  <span class="number">3</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>,  <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>,  <span class="number">0</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>,  <span class="number">3</span>, <span class="number">11</span>,  <span class="number">5</span>,  <span class="number">2</span>, <span class="number">12</span>]</span><br><span class="line"><span class="comment"># S4盒</span></span><br><span class="line">S4 = [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>,  <span class="number">3</span>,  <span class="number">0</span>,  <span class="number">6</span>,  <span class="number">9</span>, <span class="number">10</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>,  <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>,  <span class="number">8</span>, <span class="number">11</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>,  <span class="number">9</span>,</span><br><span class="line">      <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">9</span>,  <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>,  <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>,  <span class="number">1</span>,  <span class="number">3</span>, <span class="number">14</span>,  <span class="number">5</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">4</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">10</span>,  <span class="number">1</span>, <span class="number">13</span>,  <span class="number">8</span>,  <span class="number">9</span>,  <span class="number">4</span>,  <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>,  <span class="number">7</span>,  <span class="number">2</span>, <span class="number">14</span>]</span><br><span class="line"><span class="comment"># S5盒</span></span><br><span class="line">S5 = [<span class="number">2</span>, <span class="number">12</span>,  <span class="number">4</span>,  <span class="number">1</span>,  <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">5</span>,  <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>,  <span class="number">0</span>, <span class="number">14</span>,  <span class="number">9</span>,</span><br><span class="line">      <span class="number">14</span>, <span class="number">11</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">4</span>,  <span class="number">7</span>, <span class="number">13</span>,  <span class="number">1</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>,  <span class="number">3</span>,  <span class="number">9</span>,  <span class="number">8</span>,  <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>,  <span class="number">7</span>,  <span class="number">8</span>, <span class="number">15</span>,  <span class="number">9</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">3</span>,  <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">      <span class="number">11</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">7</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">2</span>, <span class="number">13</span>,  <span class="number">6</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">9</span>, <span class="number">10</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">3</span>]</span><br><span class="line"><span class="comment"># S6盒</span></span><br><span class="line">S6 = [<span class="number">12</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>,  <span class="number">9</span>,  <span class="number">2</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">0</span>, <span class="number">13</span>,  <span class="number">3</span>,  <span class="number">4</span>, <span class="number">14</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">15</span>,  <span class="number">4</span>,  <span class="number">2</span>,  <span class="number">7</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">3</span>,  <span class="number">8</span>,</span><br><span class="line">      <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>,  <span class="number">5</span>,  <span class="number">2</span>,  <span class="number">8</span>, <span class="number">12</span>,  <span class="number">3</span>,  <span class="number">7</span>,  <span class="number">0</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>,  <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>,  <span class="number">3</span>,  <span class="number">2</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>,  <span class="number">1</span>,  <span class="number">7</span>,  <span class="number">6</span>,  <span class="number">0</span>,  <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line"><span class="comment"># S7盒</span></span><br><span class="line">S7 = [<span class="number">4</span>, <span class="number">11</span>,  <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>,  <span class="number">0</span>,  <span class="number">8</span>, <span class="number">13</span>,  <span class="number">3</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">7</span>,  <span class="number">5</span>, <span class="number">10</span>,  <span class="number">6</span>,  <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>,  <span class="number">0</span>, <span class="number">11</span>,  <span class="number">7</span>,  <span class="number">4</span>,  <span class="number">9</span>,  <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>,  <span class="number">3</span>,  <span class="number">5</span>, <span class="number">12</span>,  <span class="number">2</span>, <span class="number">15</span>,  <span class="number">8</span>,  <span class="number">6</span>,</span><br><span class="line">      <span class="number">1</span>,  <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>,  <span class="number">3</span>,  <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>,  <span class="number">6</span>,  <span class="number">8</span>,  <span class="number">0</span>,  <span class="number">5</span>,  <span class="number">9</span>,  <span class="number">2</span>,</span><br><span class="line">      <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>,  <span class="number">8</span>,  <span class="number">1</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">7</span>,  <span class="number">9</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>,  <span class="number">2</span>,  <span class="number">3</span>, <span class="number">12</span>]</span><br><span class="line"><span class="comment"># S8盒</span></span><br><span class="line">S8 = [<span class="number">13</span>,  <span class="number">2</span>,  <span class="number">8</span>,  <span class="number">4</span>,  <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>,  <span class="number">1</span>, <span class="number">10</span>,  <span class="number">9</span>,  <span class="number">3</span>, <span class="number">14</span>,  <span class="number">5</span>,  <span class="number">0</span>, <span class="number">12</span>,  <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>,  <span class="number">8</span>, <span class="number">10</span>,  <span class="number">3</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">12</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">11</span>,  <span class="number">0</span>, <span class="number">14</span>,  <span class="number">9</span>,  <span class="number">2</span>,</span><br><span class="line">      <span class="number">7</span>, <span class="number">11</span>,  <span class="number">4</span>,  <span class="number">1</span>,  <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>,  <span class="number">2</span>,  <span class="number">0</span>,  <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>,  <span class="number">3</span>,  <span class="number">5</span>,  <span class="number">8</span>,</span><br><span class="line">      <span class="number">2</span>,  <span class="number">1</span>, <span class="number">14</span>,  <span class="number">7</span>,  <span class="number">4</span>, <span class="number">10</span>,  <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>,  <span class="number">9</span>,  <span class="number">0</span>,  <span class="number">3</span>,  <span class="number">5</span>,  <span class="number">6</span>, <span class="number">11</span>]</span><br><span class="line"><span class="comment"># S盒</span></span><br><span class="line">S = [S1,S2,S3,S4,S5,S6,S7,S8]</span><br><span class="line"><span class="comment"># p盒</span></span><br><span class="line">p_table = [<span class="number">16</span>,  <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">           <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,  <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">           <span class="number">2</span>,  <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>,  <span class="number">3</span>,  <span class="number">9</span>,</span><br><span class="line">           <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>,  <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>,  <span class="number">4</span>, <span class="number">25</span>]</span><br><span class="line"><span class="comment"># 10进制转4位二进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2bit</span>(<span class="params">n</span>):</span></span><br><span class="line">    a = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        a.insert(<span class="number">0</span>,<span class="built_in">str</span>(n%<span class="number">2</span>))</span><br><span class="line">        n = <span class="built_in">int</span>(n/<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="comment"># IP置换，op为0为加密置换，op为1表示解密置换</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">IP</span>(<span class="params">text,op</span>):</span></span><br><span class="line">    temp = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            temp[i] = text[IP_table[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> temp</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            temp[i] = text[Inv_IP_table[i]-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> temp</span><br><span class="line"><span class="comment"># E盒扩展</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Extend</span>(<span class="params">text</span>):</span></span><br><span class="line">    extend = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">        extend[i] = text[extend_table[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span>  extend</span><br><span class="line"><span class="comment"># S盒变换</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">s_Replace</span>(<span class="params">text</span>):</span></span><br><span class="line">    sResult = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        row = <span class="number">2</span> * <span class="built_in">int</span>(text[k*<span class="number">6</span>]) + <span class="built_in">int</span>(text[k*<span class="number">6</span>+<span class="number">5</span>])</span><br><span class="line">        column = <span class="number">8</span>*<span class="built_in">int</span>(text[k*<span class="number">6</span>+<span class="number">1</span>]) + <span class="number">4</span>*<span class="built_in">int</span>(text[k*<span class="number">6</span>+<span class="number">2</span>]) + <span class="number">2</span>*<span class="built_in">int</span>(text[k*<span class="number">6</span>+<span class="number">3</span>]) + <span class="built_in">int</span>(text[k*<span class="number">6</span>+<span class="number">4</span>])</span><br><span class="line">        temp = S[k][row*<span class="number">16</span>+column]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            sResult[<span class="number">4</span>*k + i] = int2bit(temp)[i]</span><br><span class="line">    <span class="keyword">return</span>  sResult</span><br><span class="line"><span class="comment"># P盒置换</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p_Replace</span>(<span class="params">text</span>):</span></span><br><span class="line">    pResult = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        pResult[i] = text[p_table[i]-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> pResult</span><br><span class="line"><span class="comment"># 异或运算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Xor</span>(<span class="params">bit1,bit2</span>):</span></span><br><span class="line">    xorResult = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bit1))]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bit1)):</span><br><span class="line">        xorResult[i] = <span class="built_in">str</span>(<span class="built_in">int</span>(bit1[i])^<span class="built_in">int</span>(bit2[i]))</span><br><span class="line">    <span class="keyword">return</span> xorResult</span><br></pre></td></tr></table></figure><h3 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># /*</span></span><br><span class="line"><span class="comment">#  * @Author: Barry</span></span><br><span class="line"><span class="comment">#  * @Date: 2020-03-30 16:02:41</span></span><br><span class="line"><span class="comment">#  * @Last Modified by: Barry</span></span><br><span class="line"><span class="comment">#  * @Last Modified time: 2020-03-30 16:03:52</span></span><br><span class="line"><span class="comment">#  */</span></span><br><span class="line"><span class="keyword">import</span> creatSubkey <span class="keyword">as</span> cs</span><br><span class="line"><span class="keyword">import</span>  f_Function <span class="keyword">as</span> f</span><br><span class="line"><span class="comment">#16进制转2进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2bin</span>(<span class="params">text</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)):</span><br><span class="line">        result.extend(f.int2bit(<span class="built_in">int</span>(text[i],<span class="number">16</span>)))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="comment"># 2进制转16进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin2hex</span>(<span class="params">text</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    q = <span class="built_in">len</span>(text)//<span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">        dec = <span class="built_in">int</span>(text[<span class="number">4</span>*i])*<span class="number">8</span> + <span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">1</span>])*<span class="number">4</span>+<span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">2</span>])*<span class="number">2</span> + <span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">3</span>])*<span class="number">1</span></span><br><span class="line">        x = <span class="built_in">hex</span>(dec)[<span class="number">2</span>:]</span><br><span class="line">        result.extend(x)</span><br><span class="line">    rs = <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line"><span class="comment"># 加密步骤</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESEncryption</span>(<span class="params">plaintext,secret_key</span>):</span></span><br><span class="line">    secret_key = cs.SubKey(secret_key) <span class="comment">#密钥初始置换</span></span><br><span class="line">    text1 = f.IP(plaintext,<span class="number">0</span>)</span><br><span class="line">    L = [text1[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    R = [text1[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">64</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        temp = R</span><br><span class="line">        temp = f.Extend(temp)</span><br><span class="line">        temp = f.Xor(temp,secret_key[i])</span><br><span class="line">        temp = f.s_Replace(temp)</span><br><span class="line">        temp = f.p_Replace(temp)</span><br><span class="line">        temp = f.Xor(temp,L)</span><br><span class="line">        L = R</span><br><span class="line">        R = temp</span><br><span class="line">    L,R = R,L</span><br><span class="line">    cText = L</span><br><span class="line">    cText.extend((R))</span><br><span class="line">    cText = f.IP(cText,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> bin2hex(cText)</span><br><span class="line"><span class="comment">#程序入口</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 输入明文</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;读入16位十六进制明文&#x27;</span>)</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&#x27;des_plaintext.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    plaintext = f1.read()</span><br><span class="line">    f1.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入完成&quot;</span>)</span><br><span class="line">    <span class="comment"># 输入密钥</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入16位十六进制密钥&quot;</span>)</span><br><span class="line">    <span class="comment"># with open(&#x27;des_sercetkey.txt&#x27;,&#x27;r&#x27;) as f:</span></span><br><span class="line">    <span class="comment">#     secret_key = f.read()</span></span><br><span class="line">    f2 = <span class="built_in">open</span>(<span class="string">&#x27;des_sercetkey.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    secret_key = f2.read()</span><br><span class="line">    f2.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入完成&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;算法开始&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;明文为：&quot;</span> + plaintext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密钥为：&quot;</span> + secret_key)</span><br><span class="line">    plaintext = hex2bin(plaintext)</span><br><span class="line">    secret_key = hex2bin(secret_key)</span><br><span class="line">    <span class="comment"># 算法开始</span></span><br><span class="line">    Ciphertext = DESEncryption(plaintext, secret_key)</span><br><span class="line">    <span class="comment"># 打印密文</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加密后密文为&quot;</span> + Ciphertext)</span><br></pre></td></tr></table></figure><h3 id="解密函数"><a href="#解密函数" class="headerlink" title="解密函数"></a>解密函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> creatSubkey <span class="keyword">as</span> cs</span><br><span class="line"><span class="keyword">import</span> f_Function <span class="keyword">as</span> f</span><br><span class="line"><span class="comment">#16进制转2进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2bin</span>(<span class="params">text</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)):</span><br><span class="line">        result.extend(f.int2bit(<span class="built_in">int</span>(text[i],<span class="number">16</span>)))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="comment"># 2进制转16进制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin2hex</span>(<span class="params">text</span>):</span></span><br><span class="line">    result = []</span><br><span class="line">    q = <span class="built_in">len</span>(text)//<span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(q):</span><br><span class="line">        dec = <span class="built_in">int</span>(text[<span class="number">4</span>*i])*<span class="number">8</span> + <span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">1</span>])*<span class="number">4</span>+<span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">2</span>])*<span class="number">2</span> + <span class="built_in">int</span>(text[<span class="number">4</span>*i+<span class="number">3</span>])*<span class="number">1</span></span><br><span class="line">        x = <span class="built_in">hex</span>(dec)[<span class="number">2</span>:]</span><br><span class="line">        result.extend(x)</span><br><span class="line">    rs = <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decryption</span>(<span class="params">text,key</span>):</span></span><br><span class="line">    keylist = cs.SubKey(key)</span><br><span class="line">    text1 = f.IP(text,<span class="number">0</span>)</span><br><span class="line">    L = [text1[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    R = [text1[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">64</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        temp = R</span><br><span class="line">        temp = f.Extend(temp)</span><br><span class="line">        temp = f.Xor(temp, keylist[<span class="number">15</span>-i])</span><br><span class="line">        temp = f.s_Replace(temp)</span><br><span class="line">        temp = f.p_Replace(temp)</span><br><span class="line">        temp = f.Xor(temp, L)</span><br><span class="line">        L = R</span><br><span class="line">        R = temp</span><br><span class="line">    L, R = R, L</span><br><span class="line">    cText = L</span><br><span class="line">    cText.extend((R))</span><br><span class="line">    cText = f.IP(cText, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> bin2hex(cText)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;读入16位十六进制密文&#x27;</span>)</span><br><span class="line">    f1 = <span class="built_in">open</span>(<span class="string">&#x27;des_ciphertext.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    ciphertext = f1.read()</span><br><span class="line">    f1.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入完成&quot;</span>)</span><br><span class="line">    <span class="comment"># 输入密钥</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入16位十六进制密钥&quot;</span>)</span><br><span class="line">    <span class="comment"># with open(&#x27;des_sercetkey.txt&#x27;,&#x27;r&#x27;) as f:</span></span><br><span class="line">    <span class="comment">#     secret_key = f.read()</span></span><br><span class="line">    f2 = <span class="built_in">open</span>(<span class="string">&#x27;des_sercetkey.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    secret_key = f2.read()</span><br><span class="line">    f2.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;读入完成&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;算法开始&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密文为：&quot;</span> + ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密钥为：&quot;</span> + secret_key)</span><br><span class="line">    ciphertext = hex2bin(ciphertext)</span><br><span class="line">    secret_key = hex2bin(secret_key)</span><br><span class="line">    <span class="comment"># 算法开始</span></span><br><span class="line">    plaintext = Decryption(ciphertext, secret_key)</span><br><span class="line">    <span class="comment"># 打印密文</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后明文为&quot;</span> + plaintext)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>本文参考链接：<br>原文链接：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27570955/article/details/52442092">https://blog.csdn.net/qq_27570955/article/details/52442092</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/songwenlong/p/5944139.html">https://www.cnblogs.com/songwenlong/p/5944139.html</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>Ran-Barry</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://ran-barry.github.io/2020/03/13/DES%E7%AE%97%E6%B3%95/" title="DES算法">http://ran-barry.github.io/2020/03/13/DES算法/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-cn" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E7%AE%97%E6%B3%95/" rel="tag"><i class="fa fa-tag"></i> 算法</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2020/03/13/Sublime-Text3-%E9%85%8D%E7%BD%AEpyhon%E7%8E%AF%E5%A2%83/" rel="prev" title="Sublime Text3 配置pyhon环境"><i class="fa fa-chevron-left"></i> Sublime Text3 配置pyhon环境</a></div><div class="post-nav-item"><a href="/2020/03/13/Sublime-Text3-Markdown%E6%8F%92%E4%BB%B6/" rel="next" title="Sublime Text3 Markdown插件">Sublime Text3 Markdown插件 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E6%96%87%E4%B8%BADES%E7%AE%97%E6%B3%95%E7%9A%84%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3"><span class="nav-number">1.</span> <span class="nav-text">本文为DES算法的原理详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DES%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">DES算法详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B"><span class="nav-number">2.1.</span> <span class="nav-text">算法简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%98%8E%E6%96%87%E5%88%9D%E5%A7%8B%E7%BD%AE%E6%8D%A2%EF%BC%88IP%E5%88%9D%E5%A7%8B%E7%BD%AE%E6%8D%A2%EF%BC%89"><span class="nav-number">2.2.</span> <span class="nav-text">明文初始置换（IP初始置换）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90"><span class="nav-number">2.3.</span> <span class="nav-text">密钥生成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E5%88%9D%E5%A7%8B%E7%BD%AE%E6%8D%A2%EF%BC%88%E5%AF%86%E9%92%A5%E7%94%B164%E4%BD%8D%E8%BD%AC%E4%B8%BA56%E4%BD%8D%EF%BC%89"><span class="nav-number">2.3.1.</span> <span class="nav-text">密钥初始置换（密钥由64位转为56位）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%9F%E6%88%9016%E4%B8%AA48%E4%BD%8D%E7%9A%84%E5%AD%90%E5%AF%86%E9%92%A5"><span class="nav-number">2.3.2.</span> <span class="nav-text">生成16个48位的子密钥</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E8%BD%AE%E5%BE%AA%E7%8E%AF%E5%B7%A6%E7%A7%BB1%E4%BD%8D"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">第一轮循环左移1位</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16%E8%BD%AE%E8%BF%AD%E4%BB%A3%EF%BC%88F%E5%87%BD%E6%95%B0%EF%BC%89"><span class="nav-number">2.4.</span> <span class="nav-text">16轮迭代（F函数）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%8E%E6%96%87%E6%89%A9%E5%B1%95%E7%BD%AE%E6%8D%A2%EF%BC%88E%E7%9B%92%E6%89%A9%E5%B1%9532%E4%BD%8D%E8%BD%AC48%E4%BD%8D%EF%BC%89"><span class="nav-number">2.4.1.</span> <span class="nav-text">明文扩展置换（E盒扩展32位转48位）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#S%E7%9B%92%E6%9B%BF%E4%BB%A3"><span class="nav-number">2.4.2.</span> <span class="nav-text">S盒替代</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#8%E4%B8%AAS%E7%9B%92"><span class="nav-number">2.4.2.1.</span> <span class="nav-text">8个S盒</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#P%E7%9B%92%E7%BD%AE%E6%8D%A2"><span class="nav-number">2.4.3.</span> <span class="nav-text">P盒置换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AB%E7%BD%AE%E6%8D%A2"><span class="nav-number">2.5.</span> <span class="nav-text">末置换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DES%E7%9A%84%E8%A7%A3%E5%AF%86"><span class="nav-number">2.6.</span> <span class="nav-text">DES的解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%EF%BC%88python%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">代码实现（python）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E9%83%A8%E5%88%86"><span class="nav-number">3.1.</span> <span class="nav-text">密钥生成部分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#F%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.</span> <span class="nav-text">F函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="nav-number">3.3.</span> <span class="nav-text">加密函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0"><span class="nav-number">3.4.</span> <span class="nav-text">解密函数</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">Ran-Barry</p><div class="site-description" itemprop="description"></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">46</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-cn" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Ran-Barry</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">160k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">2:25</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/haruto.model.json"},display:{superSample:2,width:150,height:300,position:"left",hOffset:0,vOffset:-10},mobile:{show:!1,scale:.05},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html>